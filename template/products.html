{% load  static %}

<!DOCTYPE html>
<html>
<head>
    <title>Products</title>

    <!-- LINK CSS MANUALLY -->
    <link rel="stylesheet" href="{% static 'products.css' %}">
</head>
<body>

<!-- TOP BAR -->
<div class="top-bar">
    <div class="title">Products Page</div>

    <div class="auth">
        {% if user.is_authenticated %}
            Logged in as <b>{{ user.username }}</b> |
            <a href="{% url 'logout_user' %}">Logout</a>
        {% else %}
            <a href="{% url 'login_user' %}">Login</a>
        {% endif %}
    </div>
</div>

<!-- NAV -->
<div class="nav">
    {% if user.is_authenticated %}
        <a href="{% url 'read_cart_user' %}">View Cart</a>
    {% else %}
        <a href="{% url 'read_cart' %}">View Cart</a>
    {% endif %}

    {% if user.is_authenticated %}
        | <a href="{% url 'add_product' %}">Add Product</a>
    {% endif %}
</div>

<hr>

<!-- PRODUCTS -->
{% for category in categories %}
<h3 class="category">{{ category.ch }}</h3>

<table class="product-table">
    <tr>
        <th>Image</th>
        <th>Product</th>
        <th>Price</th>
        <th>Action</th>
    </tr>

    {% for product in category.products.all %}
    <tr>
        <td>
            <img src="{{ product.p_image.url }}" alt="{{ product.p_name }}">
        </td>
        <td>{{ product.p_name }}</td>
        <td>â‚¹{{ product.p_price }}</td>
        <td>
            {% if user.is_authenticated %}
                <a class="btn" href="{% url 'add_cart_user' product.id %}">
                    Add to Cart
                </a>
            {% else %}
                <a class="btn" href="{% url 'add_cart' product.id %}">
                    Add to Cart
                </a>
            {% endif %}
        </td>
    </tr>
    {% empty %}
    <tr>
        <td colspan="4">No products available</td>
    </tr>
    {% endfor %}
</table>

{% endfor %}

</body>
</html>
